(this.webpackJsonpwebgui=this.webpackJsonpwebgui||[]).push([[0],{14:function(e,t,a){},27:function(e,t,a){e.exports=a.p+"static/media/icon_320x320.a641225f.png"},31:function(e,t,a){e.exports=a(61)},36:function(e,t,a){},37:function(e,t,a){},56:function(e,t,a){},61:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),o=a(30),i=a(26),r=a.n(i),c=(a(36),a(4)),l=a(5),d=a(1),h=a(7),u=a(6),m=(a(14),a(37),a(27)),f=a.n(m),g=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={username:"",password:"",newPassword:"",confirmPassword:"",change:!1},a.handleUsernameChange=a.handleUsernameChange.bind(Object(d.a)(a)),a.handlePasswordChange=a.handlePasswordChange.bind(Object(d.a)(a)),a.handleNewPasswordChange=a.handleNewPasswordChange.bind(Object(d.a)(a)),a.handleConfirmPasswordChange=a.handleConfirmPasswordChange.bind(Object(d.a)(a)),a.handleChangeMode=a.handleChangeMode.bind(Object(d.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(d.a)(a)),a}return Object(l.a)(n,[{key:"handleUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"handlePasswordChange",value:function(e){this.setState({password:e.target.value})}},{key:"handleNewPasswordChange",value:function(e){this.setState({newPassword:e.target.value})}},{key:"handleConfirmPasswordChange",value:function(e){this.setState({confirmPassword:e.target.value})}},{key:"handleChangeMode",value:function(){this.setState({change:!this.state.change})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var n=a(38).sha256,s=n(this.state.password),o=a(8);if(this.state.change)if(this.state.newPassword===this.state.confirmPassword){var i=n(this.state.newPassword),r="session?function=change&user="+encodeURIComponent(this.state.username)+"&password="+s+"&newpassword="+i;o.get(r).then((function(e){e.data?t.setState({change:!1,password:"",newPassword:"",confirmPassword:""}):t.setState({password:"",newPassword:"",confirmPassword:""})})).catch((function(e){console.log(e),t.setState({password:"",newPassword:"",confirmPassword:""})}))}else this.setState({confirmPassword:""});else{var c="session?function=login&user="+encodeURIComponent(this.state.username)+"&password="+s;o.get(c).then((function(e){e.data?t.props.login(t.state.username,e.data.token,e.data.permissions):t.setState({password:"",newPassword:"",confirmPassword:""})})).catch((function(e){console.log(e)}))}}},{key:"render",value:function(){return s.a.createElement("div",{className:"welcome"},s.a.createElement("img",{className:"welcome-logo",src:f.a,alt:"Logo"}),s.a.createElement("form",{className:"welcome-form",onSubmit:this.handleSubmit},s.a.createElement("input",{className:"welcome-form-username",type:"text",value:this.state.username,placeholder:"Username",onChange:this.handleUsernameChange,autoFocus:!0}),s.a.createElement("input",{className:"welcome-form-password",type:"password",value:this.state.password,placeholder:this.state.change?"Old password":"Password",onChange:this.handlePasswordChange,required:!0}),this.state.change&&s.a.createElement("input",{className:"welcome-form-password",type:"password",value:this.state.newPassword,placeholder:"New password",onChange:this.handleNewPasswordChange,required:!0}),this.state.change&&s.a.createElement("input",{className:"welcome-form-password",type:"password",value:this.state.confirmPassword,placeholder:"Confirm password",onChange:this.handleConfirmPasswordChange,required:!0}),s.a.createElement("input",{className:"welcome-form-submit",type:"submit",value:this.state.change?"Change password":"Log in"})),s.a.createElement("a",{className:"welcome-change-mode clickable",onClick:this.handleChangeMode,title:this.state.change?"Switch to user log in mode":"Switch to change user password mode"},this.state.change?"Log in":"Change password"))}}]),n}(s.a.Component),w=a(28),p=(a(56),function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={healthy:0,symptomatic:0,confirmedDiagnosis:0},a.handleUpdateInfectionData=a.handleUpdateInfectionData.bind(Object(d.a)(a)),a.handleUpdateSummary=a.handleUpdateSummary.bind(Object(d.a)(a)),a}return Object(l.a)(n,[{key:"componentWillMount",value:function(){this.handleUpdateSummary()}},{key:"handleUpdateInfectionData",value:function(){var e=a(8),t=this.props.token,n="control?command=infectionData&token="+encodeURIComponent(t);e.get(n).then((function(e){e.data&&console.log("updateInfectionData successful")})).catch((function(e){console.log(e)}))}},{key:"handleUpdateSummary",value:function(){var e=this,t=a(8),n=this.props.token,s="control?command=summary&token="+encodeURIComponent(n);t.get(s).then((function(t){if(t.data){console.log("updateSummary successful"),console.log(t.data);var a={healthy:parseInt(t.data.status.healthy),symptomatic:parseInt(t.data.status.symptomatic),confirmedDiagnosis:parseInt(t.data.status.confirmedDiagnosis)};console.log(a),e.setState(a)}})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this.props.logout,t=this.state,a=[{title:"Healthy",value:t.healthy,color:"#34c759"},{title:"Symptomatic",value:t.symptomatic,color:"#ff9500"},{title:"Confirmed",value:t.confirmedDiagnosis,color:"#ff3b30"}];return s.a.createElement("div",{className:"dashboard"},s.a.createElement("div",{className:"dashboard-piechart"},s.a.createElement(w.PieChart,{lineWidth:15,label:function(e){var t=e.dataEntry;return Math.round(t.percentage)+"% ("+t.value+")"},labelStyle:function(e){return{fill:a[e].color,fontSize:"4px",fontFamily:"sans-serif"}},labelPosition:80,data:a})),s.a.createElement("div",{className:"dashboard-functions"},s.a.createElement("div",{className:"dashboard-functions-function clickable",onClick:this.handleUpdateInfectionData},"UPDATE"),s.a.createElement("div",{className:"dashboard-functions-function clickable",onClick:this.handleUpdateSummary},"REFRESH"),s.a.createElement("div",{className:"dashboard-functions-function clickable",onClick:e},"LOGOUT")))}}]),n}(s.a.Component)),v={mode:"welcome",username:"",token:"",permissions:[]},b=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state=JSON.parse(JSON.stringify(v)),a.setState=a.setState.bind(Object(d.a)(a)),a.login=a.login.bind(Object(d.a)(a)),a.logout=a.logout.bind(Object(d.a)(a)),a.refresh=a.refresh.bind(Object(d.a)(a)),a.refreshTime=0,a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyPress)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyPress)}},{key:"login",value:function(e,t,a){t&&this.setState({mode:"dashboard",username:e,permissions:a,token:t})}},{key:"logout",value:function(){var e=this,t="session?function=logout&token="+this.state.token;a(8).get(t).then((function(e){200===parseInt(e.status,10)?console.log("Log out successful"):console.log("Log out failed due to timeout")})).catch((function(e){console.log("Log out failed due to "+e)})).finally((function(){var t=JSON.parse(JSON.stringify(v));e.setState(t)}))}},{key:"refresh",value:function(){var e=this,t=(new Date).getTime();if(this.state.token&&t>this.refreshTime){var n="session?function=refresh&token="+this.state.token;a(8).get(n).then((function(a){200===parseInt(a.status,10)?e.refreshTime=t+6e4:console.log("Refresh failed due to timeout")})).catch((function(e){console.log("Refresh failed due to "+e)}))}}},{key:"render",value:function(){switch(this.state.mode){case"dashboard":return s.a.createElement(p,{username:this.state.username,token:this.state.token,refresh:this.refresh,logout:this.logout});default:return s.a.createElement(g,{state:this.state,login:this.login})}}}]),n}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement(o.a,{basename:"admin"},s.a.createElement(b,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[31,1,2]]]);
//# sourceMappingURL=main.cafd4ef3.chunk.js.map